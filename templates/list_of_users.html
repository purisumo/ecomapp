{% extends './includes/base.html' %}
{% block title %}List of users{% endblock %}
{% load static %}
{% block content %}
{% include "./includes/sidebar.html" %}

<section class="list-of-orders-page list_of_users seller-content">
  <div class="page-wrapper">
    <div class="page-container">
      <div class="sub-navbar">
        <div class="title">
          <p>List of users</p>
        </div>

        <div class="actions">
          <button class="border-btn-primary2 selected" data-view=".customer-section">Customers {% if customers.count > 0 %}<span class="counter-in-btn">{{customers.count}}</span>{% endif %}</button>
          <button class="border-btn-primary2" data-view=".seller-section">Sellers {% if sellers.count > 0 %}<span class="counter-in-btn">{{sellers.count}}</span>{% endif %}</button>
        </div>
      </div>

      <div class="content-section customer-section show-section">
        {% for customer in customers %}
          <div class="order-item">
            <div class="image-cont" style="height:fit-content; margin:auto 0;">
              <i class="bi bi-person-circle"></i>
            </div>
  
            <div class="item-info">
              <p class="item-name" style="font-size:1.6rem">{{ customer.get_full_name }}</p>

              <div class="label-with-value">
                <p class="label">Username: </p>
                <p class="value">{{ customer.username }}</p>
              </div>

              <div class="label-with-value">
                <p class="label">Email: </p>
                <p class="value">{{ customer.email }}</p>
              </div>

              <div class="label-with-value">
                <p class="label">Contact number: </p>
                <p class="value">{{ customer.phone_number }}</p>
              </div>

              <div class="label-with-value" style="text-wrap:wrap">
                <p class="label">Address: </p>
                <p class="value">{{ customer.address }}</p>
              </div>
            </div>
  
            <div class="more-info-wrap">
              {% if customer.is_active %}
              <p class="status completed">Active</p>
              {% else %}
              <p class="status cancelled">Banned</p>
              {% endif %}
  
              <div class="computation-cont">
                <div class="label-with-value">
                  <p class="label">Pending order: </p>
                  <p class="price">{{ first_item.product.price }}</p>
                </div>
  
                <div class="label-with-value">
                  <p class="label">Shipped fee: </p>
                  <p class="price">{{ order.delivery_fee }}</p>
                </div>
  
                <div class="label-with-value">
                  <p class="label">Completed order: </p>
                  <p class="price">{{ order.total_amount }}</p>
                </div>
  
                <div class="label-with-value">
                  <p class="label">Cancelled order: </p>
                  <p class="price">{{ order.total_amount }}</p>
                </div>
              </div>
  
              <div class="actions">
                {% if not customer.is_active %}
                <button class="primary-btn" data-modal="activate-account" data-id="{{ customer.id }}">Activate account</button>
                {% else %}
                <button class="border-btn-delete" data-modal="ban-account" data-id="{{ customer.id }}">Ban account</button>
                {% endif %}
              </div>
            </div>
          </div>
  
          <hr class="line-separator">
        {% empty %}
          <div class="empty-content" style="margin:20% 0;">
            <p>There are no customer users at the moment.</p>
          </div>
        {% endfor %}
      </div>

      <div class="content-section seller-section">
        {% for seller in sellers %}
          <div class="order-item">
            <div class="image-cont" style="height:fit-content; margin:auto 0;">
              <i class="bi bi-person-circle"></i>
              <a href="{% url 'shop:shop_info' seller.shop.id %}" class="border-btn-primary2">Visit shop</a>
            </div>
  
            <div class="item-info">
              <p class="item-name" style="font-size:1.6rem">{{ seller.get_full_name }}</p>

              <div class="label-with-value">
                <p class="label">Username: </p>
                <p class="value">{{ seller.username }}</p>
              </div>

              <div class="label-with-value">
                <p class="label">Email: </p>
                <p class="value">{{ seller.email }}</p>
              </div>

              <div class="label-with-value">
                <p class="label">Contact number: </p>
                <p class="value">{{ seller.phone_number }}</p>
              </div>

              <div class="label-with-value" style="text-wrap:wrap">
                <p class="label">Address: </p>
                <p class="value">{{ seller.address }}</p>
              </div>
            </div>
  
            <div class="more-info-wrap">
              {% if seller.is_active %}
              <p class="status completed">Active</p>
              {% else %}
              <p class="status cancelled">Banned</p>
              {% endif %}
  
              <div class="computation-cont">
                <div class="label-with-value">
                  <p class="label">Pending order: </p>
                  <p class="price">{{ first_item.product.price }}</p>
                </div>
  
                <div class="label-with-value">
                  <p class="label">Shipped fee: </p>
                  <p class="price">{{ order.delivery_fee }}</p>
                </div>
  
                <div class="label-with-value">
                  <p class="label">Completed order: </p>
                  <p class="price">{{ order.total_amount }}</p>
                </div>
  
                <div class="label-with-value">
                  <p class="label">Cancelled order: </p>
                  <p class="price">{{ order.total_amount }}</p>
                </div>
              </div>
  
              <div class="actions">
                {% if not seller.is_active %}
                <button class="primary-btn" data-modal="activate-account" data-id="{{ seller.id }}">Activate account</button>
                {% else %}
                <button class="border-btn-delete" data-modal="ban-account" data-id="{{ seller.id }}">Ban account</button>
                {% endif %}
              </div>
            </div>
          </div>
  
          <hr class="line-separator">
        {% empty %}
          <div class="empty-content" style="margin:20% 0;">
            <p>There are no seller users at the moment.</p>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
</section>

<form class="modal confirmation" method="post" id="update-order-status-modal">
  {% csrf_token %}
  <div class="modal-container">
    <div class="close"><i class="bi bi-x"></i></div>

    <div class="modal-content">
      <input type="hidden" id="selected-id" name='selected-id'>

      <div class="content-wrap">
        <p>Are you sure you want to cancel this <b>order</b>?</p>
      </div>

      <div class="button-cont-below">
        <button class="border-btn-primary2 with-icon-btn cancel-btn" type="button">
          Cancel
        </button>
        <button class="delete-btn" type="submit">
          Confirm
        </button>
      </div>
    </div>
  </div>
</form>
{% endblock %}

{% block scripts %}
<script src="{% static 'js/list_of_users.js' %}"></script>
{% endblock scripts %}